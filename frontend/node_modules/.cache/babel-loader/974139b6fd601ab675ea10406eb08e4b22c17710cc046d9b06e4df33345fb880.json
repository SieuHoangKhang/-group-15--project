{"ast":null,"code":"var _jsxFileName = \"D:\\\\MON_HOC\\\\MA_NGUON_MO\\\\TH_Buoi4\\\\-group-15--project\\\\frontend\\\\src\\\\auth\\\\AuthContext.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useMemo, useState, useCallback, useEffect } from 'react';\nimport api from '../api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(null);\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [token, setToken] = useState(null);\n  const [user, setUser] = useState(null);\n\n  // Load token từ localStorage khi mount\n  useEffect(() => {\n    const t = localStorage.getItem('token');\n    const u = localStorage.getItem('user');\n    if (t) setToken(t);\n    if (u) {\n      try {\n        setUser(JSON.parse(u));\n      } catch (_) {}\n    }\n  }, []);\n  const saveAuth = useCallback((t, u) => {\n    setToken(t);\n    setUser(u);\n    if (t) localStorage.setItem('token', t);else localStorage.removeItem('token');\n    if (u) localStorage.setItem('user', JSON.stringify(u));else localStorage.removeItem('user');\n  }, []);\n  const signup = useCallback(async ({\n    name,\n    email,\n    password\n  }) => {\n    const res = await api.post('/auth/signup', {\n      name,\n      email,\n      password\n    });\n    return res.data; // không trả token theo yêu cầu, chỉ trả user info\n  }, []);\n  const login = useCallback(async ({\n    email,\n    password\n  }) => {\n    const res = await api.post('/auth/login', {\n      email,\n      password\n    });\n    const {\n      token: t,\n      user: u\n    } = res.data || {};\n    saveAuth(t, u);\n    return u;\n  }, [saveAuth]);\n  const logout = useCallback(async () => {\n    try {\n      await api.post('/auth/logout');\n    } catch (_) {/* stateless */}\n    saveAuth(null, null);\n  }, [saveAuth]);\n  const updateProfile = useCallback(async ({\n    name,\n    email\n  }) => {\n    const res = await api.put('/auth/profile', {\n      name,\n      email\n    });\n    const updated = res.data;\n    // update local user copy\n    saveAuth(token, updated);\n    return updated;\n  }, [saveAuth, token]);\n  const value = useMemo(() => ({\n    token,\n    user,\n    signup,\n    login,\n    logout,\n    updateProfile\n  }), [token, user, signup, login, logout, updateProfile]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 10\n  }, this);\n}\n_s(AuthProvider, \"mZTWSWSA2n6pJIJ+eBLrF+as3/I=\");\n_c = AuthProvider;\nexport function useAuth() {\n  _s2();\n  const ctx = useContext(AuthContext);\n  if (!ctx) throw new Error('useAuth must be used within AuthProvider');\n  return ctx;\n}\n_s2(useAuth, \"/dMy7t63NXD4eYACoT93CePwGrg=\");\nexport default AuthContext;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useMemo","useState","useCallback","useEffect","api","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","token","setToken","user","setUser","t","localStorage","getItem","u","JSON","parse","_","saveAuth","setItem","removeItem","stringify","signup","name","email","password","res","post","data","login","logout","updateProfile","put","updated","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","ctx","Error","$RefreshReg$"],"sources":["D:/MON_HOC/MA_NGUON_MO/TH_Buoi4/-group-15--project/frontend/src/auth/AuthContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useMemo, useState, useCallback, useEffect } from 'react';\r\nimport api from '../api';\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [token, setToken] = useState(null);\r\n  const [user, setUser] = useState(null);\r\n\r\n  // Load token từ localStorage khi mount\r\n  useEffect(() => {\r\n    const t = localStorage.getItem('token');\r\n    const u = localStorage.getItem('user');\r\n    if (t) setToken(t);\r\n    if (u) {\r\n      try { setUser(JSON.parse(u)); } catch (_) {}\r\n    }\r\n  }, []);\r\n\r\n  const saveAuth = useCallback((t, u) => {\r\n    setToken(t);\r\n    setUser(u);\r\n    if (t) localStorage.setItem('token', t); else localStorage.removeItem('token');\r\n    if (u) localStorage.setItem('user', JSON.stringify(u)); else localStorage.removeItem('user');\r\n  }, []);\r\n\r\n  const signup = useCallback(async ({ name, email, password }) => {\r\n    const res = await api.post('/auth/signup', { name, email, password });\r\n    return res.data; // không trả token theo yêu cầu, chỉ trả user info\r\n  }, []);\r\n\r\n  const login = useCallback(async ({ email, password }) => {\r\n    const res = await api.post('/auth/login', { email, password });\r\n    const { token: t, user: u } = res.data || {};\r\n    saveAuth(t, u);\r\n    return u;\r\n  }, [saveAuth]);\r\n\r\n  const logout = useCallback(async () => {\r\n    try { await api.post('/auth/logout'); } catch (_) { /* stateless */ }\r\n    saveAuth(null, null);\r\n  }, [saveAuth]);\r\n\r\n  const updateProfile = useCallback(async ({ name, email }) => {\r\n    const res = await api.put('/auth/profile', { name, email });\r\n    const updated = res.data;\r\n    // update local user copy\r\n    saveAuth(token, updated);\r\n    return updated;\r\n  }, [saveAuth, token]);\r\n\r\n  const value = useMemo(() => ({ token, user, signup, login, logout, updateProfile }), [token, user, signup, login, logout, updateProfile]);\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n}\r\n\r\nexport function useAuth() {\r\n  const ctx = useContext(AuthContext);\r\n  if (!ctx) throw new Error('useAuth must be used within AuthProvider');\r\n  return ctx;\r\n}\r\n\r\nexport default AuthContext;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}